<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>US Outline Map</title>
    
    <!-- importing the all and powerful d3 -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
    <style>
        /* styling for newspaper look */
        body {
            background-color: #ffffff;
            color: #000;
            margin: 0;
            padding: 0;
            font-family: 'Georgia', serif;
            line-height: 1.6;
        }

        h3, h5 {
            text-align: center;
            font-family: 'Times New Roman', Times, serif;
            text-transform: uppercase;
            font-weight: bold;
        }

        h3 {
            font-size: 3em;
            margin-top: 20px;
            border-bottom: solid;
            border-top: solid;
            border-color: #000;
            margin-bottom: 0;
            padding-bottom: 0px;
        }

        h4 {
            font-size: 1.7em;
        }

        p {
            line-height: 1.8;
        }

        /* MAP SECTION STYLING */

        #issue {
            font-style: italic;
        }

        #date {
            font-style: italic;
        }

        #breaking-news {
            font-style: italic;
        }

        .description {
            border-bottom: solid;
            border-color: #000;
        }
        .description-row {
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin: 10px auto; 
            text-align: center;
            max-width: 900px; 
        }

        .description-row p {
            margin: 0;
        }

        .slider-container {
            text-align: center;
            margin-top: 40px;
        }

        .content-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin: 0 auto;
            max-width: 1400px;
            padding: 20px; /* placing svg in a flex row with text panel */
        }

        #subtitle {
            display: flex;
            flex-direction: column; /* making the figure 1 subtitle appear under graph svg */
        }
        .map {
            flex: 3; 
            text-align: left;
            background-color: #e5e5e5;
            margin-right: 50px;
            margin-left: -110px;
            justify-content: left;

        }

        .map svg {
            width: 100%; 
            max-width: 990px; 
            padding-right: 20px;
        }

        .text-panel {
            flex: 1; 
            margin-right: -100px;
            border: 1px solid #ccc;
            text-align: left;
            padding-left: 20px;
            padding-right: 20px;
            max-width: 600px; 
            min-width: 500px;

        }


        #tooltip {
            font-size: 0.9em;
            font-family: 'Georgia', serif;
            max-width: 250px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: absolute;
            background-color: #fff;
            border: 1px solid black;
            padding: 10px;
            border-radius: 4px;
        }

        
        /* WORD CLOUD SECTION STYLING */

        #interaction-section {
            display: flex;
            flex-direction: row;
        }

        #interaction-description {
            margin-left: 50px;
            padding-left: 20px;
            padding-right: 20px;
            border: 1px solid #ccc;

        }

        .cloud-container {
            background-color: #ccc;
            margin-left: 100px;
        }

        /* MOVIE SECTION STYLING */

        #movie-section {
            display: flex;
            flex-direction: column;
        }

        #movie-description {
            margin-left: 50px;
            padding-left: 20px;
            padding-right: 20px;
            margin-top: 30px;
            margin-right: 100px;
            border: 1px solid #ccc;

        }

        #movie-container {
            background-color: #ccc;
            justify-content: center;
            text-align: center;
            margin-top: 30px;
            margin-left: 100px;
            margin-right: 100px;
        }

        /* EXPENSE SECTION STYLING */

        #expense-section {
            display: flex;
            flex-direction: column;
            margin-left: 50px;
            margin-top: 30px;
            margin-right: 100px;

        }

        #expense-description {
            border: 1px solid #ccc;
            margin-bottom: 30px;
            padding-left: 20px;
            padding-right: 20px;

        }

        #hist-container {
            display: flex;
            flex-direction: row;
            justify-content: center;
        }

        #hist-one-container {
            display: flex;
            flex-direction: column;
            margin-right: 20px;

        }

        #hist-one {
            background-color: #ccc;

        }

        #hist-two-container {
            display: flex;
            flex-direction: column;
            margin-left: 20px
        }

        #hist-two {
            background-color: #ccc;
        }

        /* CONCLUSION SECTION STYLING */

        #conclusion-container {
            margin-right: 100px;
            margin-left: 50px;
            margin-bottom: 30px;
        }

        #conclusion {
            border: 1px solid #ccc;
            padding-left: 20px;
            padding-right: 20px;
        }
    </style>
</head>

<body>

    <div class="header">
        <div class="horizontal-line"></div>
        <h3>THE ROSWELL TIMES</h3>
        <div class="horizontal-line"></div>
    </div>
    
    <div class="description">
        <div class="description-row">
            <p id="date">December 14, 2024</p>
            <p id="breaking-news">Breaking News of Today</p>
            <p id="issue">Issue No. 5100</p>
        </div>
    </div>



    <div class="content-row">
        <!-- making map and text panel be in a horizontal flex -->
        <div id = "subtitle">
            <div class="map">
                <div class="slider-container">
                    <input type="range" id="year-slider" min="1969" max="2019" value="1975" step="1">
                    <label id="year-label" for="year-slider"> Year: 1975</label>
                </div>
                <svg id="us-map" height="770" width="990"></svg>
            </div>

            <p> <em> Figure 1: USA Map of UFO Sightings (Green dots) and Space Launches (Rockets) from 1969-2019 </em> </p>

        </div>
        
        <!-- making text section for alien communication -->
        <div class="text-panel">
            <h4><strong>Are Aliens Communicating with Us?</strong></h4>
            <p> <em> by writer and certified UFO chaser, Jillian Beck </em></p>
            <p> Since the beginning of civilization, humans have looked to the stars for meaning. From seeing stories painted in the sky, to methods of navigation, or to new horizons to be explored - the night sky has always held a promise of something more. But could it be that we are not the only ones who have looked up and dreamed of exploration? On July 20 of 1969, Neil Armstrong famously declared, <em> "One large step for man; One giant leap for mankind" </em> as he walked the first path ever made on the lunar surface. Though the Apollo 11 mission was not the first of humanity to ever reach space, that title is owned by Russia's Sputnik 1 in 1957, the moon landing did mark a revolutionary time in space exploration and human history. In fact, it may have even been the event that finally put Earth on the map for our extraterrestrial neighbors!  </p>

            <p> When examining UFO sightings across time, we can see these alien encounters move from practically no sightings to some, to dozens, and then hundreds from 1969 and beyond. Is it possible that our first big space adventure finally boosted humanity as a force to associate with in the extraterrestrial league? On the left, we have a map of all UFO sightings and space mission launches in the United States from 1969 to 2019. Use the slider to explore how as our space missions advance, so do the sightings of our ET friendly neighbors. </p>
        </div>
    </div>
    <!-- tooltip so that we can have the hover over labels appear correctly -->
    <div id="tooltip" style="display: none;"></div>

    <div id = "interaction-section">

        <div id = "interaction-description">
            <h4><strong>A Glimpse into Our Alien Interactions</strong></h4>
            <p> <em> by editor and shape-enthusiest, Hrishika Jotwani </em></p>
            <p> blah blah blah talk about shapes yada yada ya </p>
        </div>

        <div class="cloud-container"> 
            <p> word cloud goes here <p>
            <svg id="word-cloud" height="300" width="900"></svg>
        </div>
    </div>

    <div id = "movie-section"> 

        <div id = "movie-description">
            <h4><strong>How has Alien Contact Influenced Our Media? </strong></h4>
            <p> <em> by director and film-expert, Hung Ming Tseng </em></p>
            <p> blah blah blah talk about movies and top hits blah </p>
        </div>

        <div id ="movie-container"> 
            <p> movie graph goes here <p>
            <svg id="movie" height="300" width="400"></svg>
        </div>

    </div>

    <div id = "expense-section"> 
        <div id = "expense-description">
            <h4><strong>How Much is Alien Communication Costing? </strong></h4>
            <p> <em> by CFO and UFO-Wizard, Hermione Bossolina </em></p>
            <p>While individually we might pour money into watching the latest alien themed movie, books, and more, lets take a look at how much trying to communicate to extraterrestrial beings have cost us!</p>
            <p>Luckily, all of our launches to communicate to extraterrestrial beings have most succeeded! Specifically 924 of the 981 have been successful! But, what has it cost the government and companies? Specifically, lets examine how much space launches cost one of the largest and most well known space exploration companies: NASA.</p>
            <p>From around 1971 to 1986, we notice a major deinvested in NASA's budget a suprise as just a decade ago NASA landed on the moon! But since then the budget has remained around or above what it was in 1970.</p>
            <p>But that doesn't mean that NASA has deinvested in its own exploration in Space though its budget by the government is less in 2004 it began the Constellation Program and in 2006 and 2010 it was given a budget to explore the Moon, Mars, and beyond.</p>
            <p>Since NASA must submit a budget request to the government we have data on its requests: <link>https://www.planetary.org/space-policy/every-nasa-budget-request</link>. Feel free to explore!</p>
        </div>
        
        <div id = "hist-container">
            <div id = "hist-one-container">
                <svg id="hist-one" height="400" width="400"> </svg>
                <p> insert hist one description here</p>
            </div>

            <div id="hist-two-container">
                <!--<svg id="hist-two" height="200" width="200"> </svg>-->
                <svg id="rocket_success_failure" width="400" height="400"></svg>
            
            <script>
                // I call the svg svg_sf to represent success failure acronymed in SF ;) 
                let svg_sf = d3.select("svg#rocket_success_failure");
                let width_sf = svg_sf.attr("width");
                let height_sf = svg_sf.attr("height");
                // Margin Bars defined here. We can adjust top, right, bottom, and left
                let margin_bar_sf = { top: 20, right: 10, bottom: 50, left: 70 };
                // Chart Width defined using the svg, width and height, and margin bars; right, left, up, and bottom.
                let chartWidth_sf = width_sf - margin_bar_sf.left - margin_bar_sf.right;
                let chartHeight_sf = height_sf - margin_bar_sf.top - margin_bar_sf.bottom;

                // create annotations using "g" and append
                let annotations_sf = svg_sf.append("g").attr("id", "annotations_sf");
                // create chartArea
                let chartArea_sf = svg_sf.append("g")
                    .attr("id", "points_sf")
                    .attr("transform", `translate(${margin_bar_sf.left},${margin_bar_sf.top})`);


            // loading the data
            d3.csv("data/space_mission_filter_usa.csv", d3.autoType).then(data => {

                // I wanted to make a histogram that displays the frequency of each Mission 
                // to categorize the groupings because the categories (called mission_stat) is a categorical variable I decided
                // to make a dictionary to categorize the different counts.
                // This was different from the previous histogram that I made in Project 2 because that one I binned based on numerical
                // values, which makes more intuitive sense. Here I had to bin on categories of how many times a variable came.
                // This graphic is static. While I could add mouseover to include each and every ship name for success it would be too many.
                // https://www.geeksforgeeks.org/d3-js-rollup-method/
                // used https://observablehq.com/@d3/d3-group's code: d3.rollup(athletes, v => v.length, d => d.sport) 
                // this matched the groupby methods and dictionary methods that r and python, respectively, uses.
                let bins = d3.rollups(
                    data,
                    v => v.length, // frequency of each category (called mission_stat)
                    d => d["Status Mission"] // Group by Status Mission
                ).map(([key, value]) => ({ mission_stat: key, count: value })); // wanted to create a dictionary like, which represents each of the four statuses

                // Categorical data use band scale
                let xScale = d3.scaleBand()
                    .domain(bins.map(d => d.mission_stat))
                    .range([0, chartWidth_sf])
                    .padding(0.1); // add some spacing

                let bottomAxis_sf = d3.axisBottom(xScale);
                annotations_sf.append("g")
                    .attr("class", "x axis")
                    .attr("transform", `translate(${margin_bar_sf.left},${chartHeight_sf + margin_bar_sf.top + 10})`)
                    .call(bottomAxis_sf);

                // Frequency on y-axis
                let yScale = d3.scaleLinear()
                    .domain([0, d3.max(bins, d => d.count)]) // 0 to Largest count
                    .range([chartHeight_sf, 0]);

                let leftAxis_sf = d3.axisLeft(yScale);
                annotations_sf.append("g")
                    .attr("class", "y axis")
                    .attr("transform", `translate(${margin_bar_sf.left - 10},${margin_bar_sf.top})`)
                    .call(leftAxis_sf);

                // creating the chart!
                chartArea_sf.selectAll('rect.bar')
                    .data(bins)
                    .join('rect')
                    .attr('class', 'bar')
                    .attr("fill", "black")
                    .attr("x", d => xScale(d.mission_stat)) // Use mission_stat
                    .attr("y", d => yScale(d.count)) // Use count for each mission_stat
                    .attr("width", xScale.bandwidth()) 
                    .attr("height", d => chartHeight_sf - yScale(d.count)); 

                // Labels!
                annotations_sf.append("text")
                    .attr("class", "x axis-label")
                    .attr("text-anchor", "middle")
                    .attr("x", margin_bar_sf.left + chartWidth_sf / 2) // centering
                    .attr("y", chartHeight_sf + margin_bar_sf.top + 50)
                    .text("Mission Status");

                annotations_sf.append("text")
                        .attr("class", "y axis-label")
                        .attr("text-anchor", "middle")
                        .attr("x", -chartHeight_sf / 2) // Labels in center
                        .attr("y", margin_bar_sf.left - 50) // I used the code from Project 2 and adjusted the Margin_bar and -34 to -50 to fit better
                        .attr("transform", "rotate(-90)")
                        .text("Frequency");
            
                annotations_sf.append("text")
                        .attr("class", "main-title")
                        .attr("text-anchor", "middle")
                        .attr("x", margin_bar_sf.left + chartWidth_sf / 2)
                        .attr("y", 15)
                        .text("Space Mission Status");
        });
        </script>
                <p><em>Figure 5: Space Missions-Superb Success and Unfortunate Fails</em></p>
            </div>

        </div>
    </div>

    <div id="conclusion-container">
        <div id = "conclusion"> 
            <h4><strong>When Will We Talk With Them Next? </strong></h4>
            <p> <em> "So-Long! And thanks for all the fish..." </em></p>
            <p> initial conclusion here </p>
        </div>
 
    </div>

    <script>
        const svg = d3.select("#us-map");
        const width = svg.attr("width");
        const height = svg.attr("height");
        const margin = { top: 20, right: 20, bottom: 20, left: 20 };
        const mapWidth = width - margin.left - margin.right;
        const mapHeight = height - margin.top - margin.bottom;

        const map = svg.append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        async function loadData() {
            //loading in map data with async await function
            const usStates = await d3.json("data/states.json");
            console.log("Loaded correctly:", usStates); //checking loads well

            const states = usStates.features;

            //making projection to map the state lines
            const projection = d3.geoAlbersUsa()
                .fitExtent([[margin.left, margin.top], [mapWidth, mapHeight]], { type: "FeatureCollection", features: states });

            const path = d3.geoPath().projection(projection);

                    

            //adding boundaries for the state paths
            map.selectAll("path.state")
                .data(states)
                .join("path")
                .attr("class", "state")
                .attr("d", path) //creating zoom in feature for each state
                .on("click", function (event, d) {
                    const [[x0, y0], [x1, y1]] = path.bounds(d);
                    const dx = x1 - x0; 
                    const dy = y1 - y0; 
                    const x = (x0 + x1) / 2; 
                    const y = (y0 + y1) / 2; 
                    const scale = Math.max(1, Math.min(8, 0.9 / Math.max(dx / mapWidth, dy / mapHeight))); 
                    const translate = [mapWidth / 2 - scale * x, mapHeight / 2 - scale * y];

                svg.transition()
                    .duration(750)
                    .call(
                        zoom.transform,
                        d3.zoomIdentity.translate(translate[0], translate[1]).scale(scale)
                    );
        });

            //adding drag capability
            const zoom = d3.zoom()
                .scaleExtent([1, 8]) //scale limits here
                .translateExtent([[0, 0], [width, height]]) //drag area
                .on("zoom", (event) => {
                    map.attr("transform", event.transform); 
                });

            svg.call(zoom); 


            //loading in actual UFO data and Space Mission data 
            const ufoData = await d3.csv("data/filtered_ufo_data.csv");
            const rocketData = await d3.csv("data/space_mission_filter_usa.csv");

            console.log("UFO Data:", ufoData);
            console.log("Rocket Data:", rocketData);

            //creating a slider to filter through the data per year
            const slider = d3.select("#year-slider");
            const label = d3.select("#year-label");

            const updateMap = (year) => {
                //separating data to have year variable
                const filteredUFOData = ufoData.filter(d => +d.date_time === year); //getting year from date_time
                const filteredRocketData = rocketData.filter(d => +d.Year === year);

                //appending our classic circles and making them green cause aliens
                map.selectAll("circle.ufo-circle")
                    .data(filteredUFOData)
                    .join("circle")
                    .attr("class", "ufo-circle")
                    .attr("cx", d => {
                        const coords = projection([+d.city_longitude, +d.city_latitude]);
                        console.log("UFO Point Projection:", coords); // need to jitter due to overlap
                        const jitterX = Math.random() * 60 - 5; //jitterbuggggg
                        return coords ?  coords[0] - 12 + jitterX : null;
                    })

                    .attr("cy", d => {
                        const coords = projection([+d.city_longitude, +d.city_latitude]);
                        const jitterY = Math.random() * 60 - 5;
                        return coords ? coords[1] - 12 + jitterY : null;
                    })
                    .attr("r", 2)
                    .attr("fill", "green")
                    .attr("opacity", 0.8)
                    .on("mouseover", function (event, d) {
                        // Show tooltip on hover
                        d3.select("#tooltip")
                            .style("display", "block")
                            .html(`
                                <strong>City:</strong> ${d.city}<br>
                                <strong>State:</strong> ${d.state}<br>
                                <strong>Encounter:</strong> ${d.summary}
                            `);
                        d3.select(this)
                            .attr("r", 4) //expanding radius on mousover
                            .attr("opacity", 1)
                    })
                    .on("mousemove", function (event) {
                        d3.select("#tooltip")
                            .style("left", (event.pageX + 10) + "px")
                            .style("top", (event.pageY + 10) + "px");
                    })
                    .on("mouseout", function () {
                        d3.select("#tooltip").style("display", "none");
                        d3.select(this)
                            .attr("r", 2)
                            .attr("opacity", 0.8)
                    });

                //appending rocket data points (but making them look like actual rockets)
                map.selectAll("image.rocket-icon")
                    .data(filteredRocketData)
                    .join("image")
                    .attr("class", "rocket-icon")
                    .attr("x", d => {
                        const coords = projection([+d.Longitude, +d.Latitude]);
                        const jitterX = Math.random() * 80 - 5; //jitterbuggggg
                        return coords ? coords[0] - 12 + jitterX : null;
                    })
                    .attr("y", d => {
                        const coords = projection([+d.Longitude, +d.Latitude]);
                        const jitterY = Math.random() * 80 - 5; //jittering to reduce overlap
                        return coords ? coords[1] - 12 + jitterY : null;
                    })
                    .attr("width", 12) // Width of the image
                    .attr("height", 12) // Height of the image
                    .attr("xlink:href", "images/rocket.png") //icon image taken from flaticon.com
                    .on("mouseover", function (event, d) {
                        d3.select("#tooltip")
                            .style("display", "block")
                            .html(`
                                <strong>Company:</strong> ${d["Company Name"] || "No Data"}<br> 
                                <strong>Rocket:</strong> ${d["Detail"] || "No Data"}<br>
                                <strong>Location:</strong> ${d["Location"] || "No Data"}
                            `);
                        d3.select(this)
                            .attr("width", 20) 
                            .attr("height", 20) 
                    })
                    .on("mousemove", function (event) {
                        d3.select("#tooltip")
                            .style("left", `${event.pageX + 10}px`)
                            .style("top", `${event.pageY + 10}px`);
                    })
                    .on("mouseout", function () {
                        d3.select("#tooltip").style("display", "none");
                        d3.select(this)
                            .attr("width", 12) 
                            .attr("height", 12) 
                    });
            };

            //slider input listening
            slider.on("input", function () {
                const selectedYear = +this.value;
                label.text(`Year: ${selectedYear}`);
                updateMap(selectedYear);
            });

            updateMap(+slider.attr("value"));
        }

        loadData();
    </script>
</body>
</html>






